#O código baixa dados de ações para quatro empresas (PETR4.SA, BBAS3.SA, ITUB4.SA e PRIO3.SA), 
#combina esses dados em um único DataFrame e o salva em um arquivo Excel chamado "acoes.xlsx" na pasta Downloads.

import pandas as pd
import yfinance as yf
import datetime
import os

# Definir o intervalo de datas: de 01/01/2023 até 04/01/2024
start = datetime.datetime(2023, 1, 1)
end = datetime.datetime(2024, 4, 1)

# Lista de tickers das empresas
tickers = ['PETR4.SA', 'BBAS3.SA', 'ITUB4.SA', 'PRIO3.SA']

# Baixar os dados para cada empresa
petrobras = yf.download('PETR4.SA', start=start, end=end)
bb = yf.download('BBAS3.SA', start=start, end=end)
itau = yf.download('ITUB4.SA', start=start, end=end)
petrorio = yf.download('PRIO3.SA', start=start, end=end)

# Juntar os DataFrames em um único DataFrame
df = pd.concat([petrobras['Adj Close'], bb['Adj Close'], itau['Adj Close'], petrorio['Adj Close']], axis=1)
df.columns = ['Petrobras', 'Banco do Brasil', 'Itaú', 'PetroRio']  # Renomear as colunas

# Imprimir as primeiras linhas do DataFrame
print(df.head())

# Resetar o índice para incluir a coluna de datas no DataFrame
df.reset_index(inplace=True)

# Salvar o DataFrame df para Excel
df.to_excel('acoes.xlsx', index=False)

# Obter o caminho da pasta de downloads
caminho = os.path.join(os.path.expanduser('~'), 'Downloads')

# Salvar o Excel na pasta de downloads
df.to_excel(os.path.join(caminho, 'acoes.xlsx'), index=False)
